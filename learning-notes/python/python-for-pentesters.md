# 1. Subdomain Enumeration (thu thập subdomain)
- Tìm subdomain được sử dụng bởi target organization là cách thức hiệu quả để mở rộng bề mặt tấn công (the attack surface) và phát hiện thêm nhiều lỗ hỏng bảo mật (vulnerabilities).
- Script này sử dụng 1 danh sách các subdomain tiềm năng và ghép chúng với tên miền (domain) được cung cấp thông qua command-line argument.
- Script sẽ thử kết nối với subdomain và giả định rằng các subdomain chấp nhận kết nối là những subdomain tồn tại.

# 2. Directory Enumeration (liệt kê thư mục)
- Trinh xác (reconnaissance) là bước quan trọng để thành công trong penetration testing. Một khi đã tìm ra được subdomain, bước tiếp theo là tìm ra directories.
- Script gần giống với Subdomain Enumeration, dựa trên vòng lặp for và bỏ qua những **status_code==404**.

- Ví dụ: target IP address của chúng ta là **10.10.8.188**, sau khi tấn công bằng lệnh `python3 dirnum.py 10.10.8.188`, ta nhận được các "Valid directory" như sau:

![dirnum.py](/images/dirnum.PNG)

- Để xem được các file html, dùng wget để tải về, ví dụ `wget -r http://10.10.8.188/surfer.html`

# 3. Network Scanner
- Có thể tạo ra 1 ICMP scanner từ python để xác định mục tiêu tìm năng trên network. Tuy nhiên, ICMP packet có thể đc theo dõi hoặc chặn vì các tổ chức k muốn người dùng thường xuyên ping máy chủ. Hoặc hệ thống có thể cấu hình k phản hồi các ICMP request. 
- Vậy nên dùng ARP để xác định các mục tiêu trên local network (LAN) là cách hiệu quả hơn vì ARP là cách bắt buộc để máy tính tìm đchi MAC của nhau, hệ thống k thể chặn ARP dễ dàng vì nó là thành phần cốt lõi của giao tiếp mạng.

## 3.1 Scapy
- Tool sử dụng thư viện **Scapy** - dùng để tạo, gửi, nhận và phân tích gói tin mạng.
- Cách cài đặt scapy: `pip install scapy`
- Import toàn bộ thư viện scapy: `from scapy.all import *`

## 3.2 ARP (address resolution protocol)
- Khi 1 máy tính trong mạng muốn giao tiếp vs một máy khác, nó cần biết đchi MAC của máy đó. 
- Nếu máy tính chỉ có đchi IP của máy kia, nó sẽ gửi 1 gói tin **ARP request** để hỏi "Ai dùng đchi IP này?". 
- Máy đích sẽ trả lời bằng đchi MAC của nó - **ARP reply**.

## 3.3 ARP request gồm:
- Sender MAC: đchi MAC người gửi
- Sender IP: đchi IP người gửi
- Target MAC: đchi MAC của máy đích (broadcast: ff:ff:ff:ff:ff:ff)
- Target IP: đchi IP cần tìm MAC.

## 3.4 Từng phần của CT quét mạng
**1. Gửi thử 1 gói tin ARP**
```
from scapy.all import *

# Tạo 1 gói tin ARP request
arp_request = ARP(pdst="192.168.1.1")

# Hiển thị thông tin gói tin
arp_request.show()
```
- `ARP(pdst="192.168.1.1")` giúp tạo ARP request hỏi **"Ai đang dùng IP 196.168.1.1"**.
- `.show()`: in ra thông tin của gói tin xem nó chứa gì
=> Khi chạy CT, bạn sẽ thấy thông tin của gói tin ARP request với các trường như pdst, hwsrc, psrc...

**2. Gửi ARP Request đến toàn bộ mạng**
- Bây giờ, thay vì hỏi 1 IP, ta sẽ hỏi cả mạng /24 (256 IP).
```
arp_request = ARP(pdst="192.168.1.0/24")
arp_request.show()
```
=> Quét cả dải đchi mạng từ: 192.168.1.1 -> 192.168.1.254

**3. Đóng gói ARP trong Ethernet**
- Máy tính giao tiếp qua **Ethernet**, nên chúng ta cần thêm **Ethernet frame**.
```
ethernet_frame = Ether(dst="ff:ff:ff:ff:ff:ff")
packet = ethernet_frame / arp_request # ghép Ethernet + ARP 

packet.show()
```
- `Ether(dst="ff:ff:ff:ff:ff:ff")`: đchi **broadcast** gửi đến tất cả máy trong mạng.
- `/`: toán tử ghép trong Scapy.

**4. Gửi gói tin và nhận phản hồi**
